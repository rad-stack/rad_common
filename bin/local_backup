#!/usr/bin/env ruby
require 'fileutils'

def system!(*args)
  system(*args) || abort("\n== Command #{args} failed ==")
end

if Dir.pwd.include?('rad_common')
  puts "== rad_common is not applicable for this operation =="
else
  heroku_app_name = Dir.pwd.split("/").last.gsub('_', '-')

  FileUtils.chdir Dir.pwd do
    system!("bundle exec rails \"heroku:local_backup[#{heroku_app_name}]\"")
  end
end
